managed implementation in class zbp_gr_setup_app_head unique;
strict ( 2 );
with draft;

define behavior for ZR_SETUP_GR_HEAD //alias <alias_name>
persistent table zqm_gr_setup_app
draft table zqm_t_setup_hd_d
with additional save

etag master LocalLastChangedOn
lock master total etag ChangedOn
authorization master ( instance )
//etag master <field_name>
{
  create ( authorization : none );
  update;
  delete;
  draft action Edit;
  draft action Activate optimized;
  draft action Discard;
  draft action Resume;
  draft determine action Prepare;
  field ( readonly ) setupapprovalno, Drgno, RmSpecification, Partno, Grade;
  determination createSetupNo on save { create; }

  field ( numbering : managed, readonly ) Cuuid;
  association _Item { create; with draft; }
  factory action getItem [1..*];
  side effects
  { action getItem affects $self;

    field Material affects field Drgno,
        field RmSpecification,
        field Partno,
        field Grade;
  }
  field ( readonly ) CreatedOn, createdby,
  changedon, changedby,
  locallastchangedon, locallastchangedby, rawmatspec, partdesc;

  action getpdf result [1] $self;
  determination updateHeaderDetails on modify { field Material; }

  field ( features : instance ) Plant, Manufacturingorder, Material, Batch;
  mapping for zqm_gr_setup_app
    {
      Cuuid                   = cuuid;
      Inspectionlot           = inspectionlot;
      Lotcreate               = lotcreate;
      Startofinsp             = startofinsp;
      Endofinsp               = endofinsp;
      Plant                   = plant;
      Material                = material;
      Customer                = customer;
      Baseunit                = baseunit;
      Manufacturingorder      = manufacturingorder;
      Inspectionlotobjecttext = inspectionlotobjecttext;
      Batch                   = batch;
      Supplier                = supplier;
      Manufacturer            = manufacturer;
      Inspectionoperation     = inspectionoperation;
      Inspection              = inspection;
      Salesorder              = salesorder;
      Drgno                   = drgno;
      RmSpecification         = rm_specification;
      Grade                   = grade;
      Partno                  = partno;
      Operationtext           = operationtext;
      Workcentertext          = workcentertext;
      Operationconfirmation   = operationconfirmation;
      Shift                   = shift;
      Operatorname            = operatorname;
      Previousopt             = previousopt;
      Nextopt                 = nextopt;
      Filename                = filename;
      Attachments             = attachments;
      Mimetype                = mimetype;
      Materialdescription     = materialdescription;
      Customername            = customername;
      QtyChkd                 = qty_chkd;
      InvNo                   = inv_no;
      InvDate                 = inv_date;
      CustDraw                = cust_draw;
      SksDraw                 = sks_draw;
      Materiallongtxt         = materiallongtxt;
      FilenameUl              = filename_ul;
      AttachmentsUl           = attachments_ul;
      MimetypeUl              = mimetype_ul;
      Formtype                = formtype;
      refnum                  = refnum;
      partdesc                = partdesc;
      rawmatspec              = rawmatspec;
      operator                = operator;
      currentoperationno      = currentoperationno;
      operationdetails        = operationdetails;
      inspector               = inspector;
      previousoperation       = previousoperation;
      nextoperation           = nextoperation;
      dateshift               = dateshift;
      machine                 = machine;
      remarks                 = remarks;
      inspectby               = inspectby;
      submittedtoprd          = submittedtoprd;
      submittedtoqa           = submittedtoqa;
      submittedtoprd_time     = submittedtoprd_time;
      submittedtoqa_time      = submittedtoqa_time;
      setupapprovalno         = setupapprovalno;
      zdate                   = zdate;
      CreatedOn               = created_on;
      CreatedBy               = created_by;
      ChangedOn               = changed_on;
      ChangedBy               = changed_by;
      LocalLastChangedOn      = local_last_changed_on;
      LocalLastChangedBy      = local_last_changed_by;
    }
}

define behavior for ZR_SETUP_GR_ITEM //alias <alias_name>
persistent table zqm_gr_setup_ap2
draft table zqm_t_setup_i_d
with additional save
lock dependent by _HDR
authorization dependent by _HDR
//etag master <field_name>
{
  update;
  delete;
  field ( readonly ) Cuuid, Itemno, Parameters, Specifications, Mmr;
  association _HDR { with draft; }

}
